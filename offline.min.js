/*! offline 0.4.0 */
(function(){var a,b,c,d,e,f,g;d=function(a,b){var c,d,e,f;f=[];for(d in b.prototype)try{e=b.prototype[d],null==a[d]&&"function"!=typeof e?f.push(a[d]=e):f.push(void 0)}catch(g){c=g}return f},a={},null==a.options&&(a.options={}),c={checks:{xhr:{url:function(){return"/offline-test-request/"+Math.floor(1e9*Math.random())}},image:{url:function(){return"http://dqakt69vkj09v.cloudfront.net/are-we-online.gif?_="+Math.floor(1e9*Math.random())}},active:"image"},checkOnLoad:!1,interceptRequests:!0},e=function(a,b){var c,d,e,f,g,h;for(c=a,h=b.split("."),d=f=0,g=h.length;g>f&&(e=h[d],c=c[e],"object"==typeof c);d=++f);return c},a.getOption=function(b){var d,f;return d=null!=(f=e(a.options,b))?f:e(c,b),"function"==typeof d?d():d},"function"==typeof window.addEventListener&&window.addEventListener("online",function(){return setTimeout(a.confirmUp,100)},!1),"function"==typeof window.addEventListener&&window.addEventListener("offline",function(){return a.confirmDown()},!1),a.state="up",a.markUp=function(){return a.trigger("confirmed-up"),"up"!==a.state?(a.state="up",a.trigger("up")):void 0},a.markDown=function(){return a.trigger("confirmed-down"),"down"!==a.state?(a.state="down",a.trigger("down")):void 0},f={},a.on=function(b,c,d){var e,g,h,i,j;if(g=b.split(" "),g.length>1){for(j=[],h=0,i=g.length;i>h;h++)e=g[h],j.push(a.on(e,c,d));return j}return null==f[b]&&(f[b]=[]),f[b].push([d,c])},a.off=function(a,b){var c,d,e,g,h;if(null!=f[a]){if(b){for(d=0,h=[];d<f[a].length;)g=f[a][d],c=g[0],e=g[1],e===b?h.push(f[a].splice(d--,1)):h.push(void 0);return h}return f[a]=[]}},a.trigger=function(a){var b,c,d,e,g,h,i;if(null!=f[a]){for(g=f[a],i=[],d=0,e=g.length;e>d;d++)h=g[d],b=h[0],c=h[1],i.push(c.call(b));return i}},b=function(a,b,c){var d,e;return d=function(){return a.status&&a.status<12e3?b():c()},null===a.onprogress?(a.addEventListener("error",c,!1),a.addEventListener("timeout",c,!1),a.addEventListener("load",d,!1)):(e=a.onreadystatechange,a.onreadystatechange=function(){return 4===a.readyState?d():0===a.readyState&&c(),"function"==typeof e?e.apply(null,arguments):void 0})},a.checks={},a.checks.xhr=function(){var c;return c=new XMLHttpRequest,c.open("GET",a.getOption("checks.xhr.url"),!0),b(c,a.markUp,a.markDown),c.send(),c},a.checks.image=function(){var b;return b=document.createElement("img"),b.onerror=a.markDown,b.onload=a.markUp,b.src=a.getOption("checks.image.url"),void 0},a.check=function(){return a.trigger("checking"),a.checks[a.getOption("checks.active")]()},a.confirmUp=a.confirmDown=a.check,a.onXHR=function(a){var b,c,e;return b=function(b,c){var d;return d=b.open,b.open=function(e,f,g,h,i){return a({type:e,url:f,async:g,flags:c,user:h,password:i,xhr:b}),d.apply(b,arguments)}},e=window.XMLHttpRequest,window.XMLHttpRequest=function(a){var c,d,f;return c=new e(a),b(c,a),f=c.setRequestHeader,c.headers={},c.setRequestHeader=function(a,b){return c.headers[a]=b,f.call(c,a,b)},d=c.overrideMimeType,c.overrideMimeType=function(a){return c.mimeType=a,d.call(c,a)},c},d(window.XMLHttpRequest,e),null!=window.XDomainRequest?(c=window.XDomainRequest,window.XDomainRequest=function(){var a;return a=new c,b(a),a},d(window.XDomainRequest,c)):void 0},g=function(){return a.getOption("interceptRequests")&&a.onXHR(function(c){var d;return d=c.xhr,b(d,a.confirmUp,a.confirmDown)}),a.getOption("checkOnLoad")?a.check():void 0},setTimeout(g,0),window.Offline=a}).call(this),function(){var a,b,c,d,e,f;if(!window.Offline)throw new Error("Pegasus brought in without offline.js");c=[],f=!1,d=function(a){return"down"!==Offline.state&&(f=!0),c.push(a)},e=function(a){var b,c,d,e,f,g,h,i,j;i=a.xhr,f=a.url,e=a.type,g=a.user,d=a.password,b=a.body,i.abort(),i.open(e,f,!0,g,d),j=i.headers;for(c in j)h=j[c],i.setRequestHeader(c,h);return i.mimeType&&i.overrideMimeType(i.mimeType),i.send(b)},a=function(){return c=[]},b=function(){var b,d,f,g,h,i;for(f={},h=0,i=c.length;i>h;h++)d=c[h],g=d.url.replace(/(\?|&)_=[0-9]+/,function(a,b){return"?"===b?b:""}),f[""+d.type.toUpperCase()+" - "+g]=d;for(b in f)d=f[b],e(d);return a()},Offline.on("confirmed-up",function(){return f?(f=!1,a()):void 0}),Offline.on("up",b),Offline.on("down",function(){return f=!1}),Offline.onXHR(function(a){var b,c,e,f,g;return e=a.xhr,b=a.async,c=function(){return d(a)},g=e.send,e.send=function(b){return a.body=b,g.apply(e,arguments)},b?null===e.onprogress?(e.addEventListener("error",c,!1),e.addEventListener("timeout",c,!1)):(f=e.onreadystatechange,e.onreadystatechange=function(){return 0===e.readyState?c():4===e.readyState&&(0===e.status||e.status>=12e3)&&c(),"function"==typeof f?f.apply(null,arguments):void 0}):void 0}),Offline.requests={flush:b,clear:a}}.call(this),function(){var a,b,c,d,e,f,g,h,i,j;if(!window.Offline)throw new Error("Offline Reconnect brought in without offline.js");a=3,e=Offline.reconnect={},g=null,(f=function(){return null!=e.state&&Offline.trigger("reconnect:stopped"),e.state="inactive",e.remaining=e.delay=a})(),c=function(){return e.remaining=e.delay=Math.min(Math.ceil(1.5*e.delay),3600)},h=function(){return"connecting"!==e.state?(e.remaining-=1,Offline.trigger("reconnect:tick"),0===e.remaining?i():void 0):void 0},i=function(){return"waiting"===e.state?(Offline.trigger("reconnect:connecting"),e.state="connecting",Offline.check()):void 0},b=function(){return e.state="waiting",Offline.trigger("reconnect:started"),g=setInterval(h,1e3)},j=function(){return clearInterval(g),f()},d=function(){return"connecting"===e.state?(Offline.trigger("reconnect:failure"),e.state="waiting",c()):void 0},Offline.on("down",b),Offline.on("confirmed-down",d),Offline.on("up",j),e.tryNow=i}.call(this),function(){var a,b,c,d,e,f,g,h,i,j,k,l,m;a=b=i=l=m=k=g=c=null,h=function(){return a=document.createElementNS("http://www.w3.org/2000/svg","svg"),a.setAttribute("style","width: 100%; height: 100%; margin: -8px;"),a.setAttribute("viewBox","0 0 1000 1000"),document.body.appendChild(a),b=document.createElementNS("http://www.w3.org/2000/svg","circle"),b.setAttribute("r",20),(g=function(){return b.setAttribute("cx",20|960*Math.random()),b.setAttribute("cy",20|960*Math.random())})(),a.appendChild(b),k={direction:0,nodes:[]},i=0,l=10,m=!1,f()},f=function(){var d,e,h,j,n,o,p,q,r;if(!m)return h=k.nodes[k.nodes.length-1],h?(j=+h.getAttribute("cx"),n=+h.getAttribute("cy")):(j=500,n=500),k.nodes.length>i&&(r=k.nodes.shift(),a.removeChild(r)),o=j+Math.cos(k.direction)*l,p=n+Math.sin(k.direction)*l,q=document.createElementNS("http://www.w3.org/2000/svg","circle"),q.setAttribute("r",20),q.setAttribute("cx",o),q.setAttribute("cy",p),c&&(q.style.fill=c),d=+b.getAttribute("cx"),e=+b.getAttribute("cy"),o>d-20&&d+20>o&&p>e-20&&e+20>p&&(i++,l++,g()),a.appendChild(q),k.nodes.push(q),requestAnimationFrame(f)},e=function(a){var b;return 37<=(b=a.keyCode)&&40>=b?(k.direction=Math.PI/2*((a.keyCode-35)%4),!1):void 0},j=function(){return document.addEventListener("keydown",e),h()},d=function(){return document.removeEventListener("keydown",e),m=!0,document.removeChild(a)},Offline.getOption("game")&&(Offline.on("down",j),Offline.on("up",d),Offline.on("reconnect:failure",function(){return c="red",setTimeout(function(){return c="black"},2e3)}))}.call(this),function(){var a,b,c,d,e,f,g,h,i,j,k;if(!window.Offline)throw new Error("Offline UI brought in without offline.js");b='<div class="offline-ui"><div class="offline-ui-content"></div></div>',a='<a href class="offline-ui-retry"></a>',e=function(a){var b;return b=document.createElement("div"),b.innerHTML=a,b.children[0]},f=d=null,c=function(a){return j(a),f.className+=" "+a},j=function(a){return f.className=f.className.replace(new RegExp("(^| )"+a.split(" ").join("|")+"( |$)","gi")," ")},h={},g=function(a,b){return c(a),null!=h[a]&&clearTimeout(h[a]),h[a]=setTimeout(function(){return j(a),delete h[a]},1e3*b)},i=function(a){var b,c,d,e;b={d:86400,h:3600,m:60,s:1},e="";for(c in b)d=b[c],a>=d&&(e+=""+Math.floor(a/d)+c+" ",a%=d);return e||(e="now"),e.trim()},(k=function(){return f=e(b),document.body.appendChild(f),null!=Offline.reconnect&&(f.appendChild(e(a)),f.querySelector(".offline-ui-retry").addEventListener("click",function(a){return a.preventDefault(),Offline.reconnect.tryNow()},!1)),c("offline-ui-"+Offline.state),d=f.querySelector(".offline-ui-content")})(),Offline.on("up",function(){return j("offline-ui-down"),c("offline-ui-up"),g("offline-ui-up-2s",2),g("offline-ui-up-5s",5)}),Offline.on("down",function(){return j("offline-ui-up"),c("offline-ui-down"),g("offline-ui-down-2s",2),g("offline-ui-down-5s",5)}),Offline.on("reconnect:connecting",function(){return c("offline-ui-connecting"),j("offline-ui-waiting")}),Offline.on("reconnect:tick",function(){return c("offline-ui-waiting"),j("offline-ui-connecting"),d.setAttribute("data-retry-in-seconds",Offline.reconnect.remaining),d.setAttribute("data-retry-in",i(Offline.reconnect.remaining))}),Offline.on("reconnect:stopped",function(){return j("offline-ui-connecting offline-ui-waiting"),d.setAttribute("data-retry-in-seconds",null),d.setAttribute("data-retry-in",null)}),Offline.on("reconnect:failure",function(){return g("offline-ui-reconnect-failed-2s",2),g("offline-ui-reconnect-failed-5s",5)}),Offline.on("reconnect:success",function(){return g("offline-ui-reconnect-succeeded-2s",2),g("offline-ui-reconnect-succeeded-5s",5)})}.call(this);